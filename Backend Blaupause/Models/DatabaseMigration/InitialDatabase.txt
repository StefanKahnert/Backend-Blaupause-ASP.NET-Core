
CREATE TABLE public."Permission" (
    "Id" text NOT NULL,
    "Name" text,
    "NormalizedName" text,
    "ConcurrencyStamp" text
);


ALTER TABLE public."Permission" OWNER TO postgres;


CREATE TABLE public."User" (
    "Id" text NOT NULL,
    "UserName" text NOT NULL,
    "NormalizedUserName" text,
    "Email" text,
    "NormalizedEmail" text,
    "EmailConfirmed" bool,
    "PasswordHash" text NOT NULL,
    "SecurityStamp" text,
    "ConcurrencyStamp" text,
    "PhoneNumber" text,
	"PhoneNumberConfirmed" bool,
    "TwoFactorEnabled" bool,
    "LockoutEnd" time without time zone,
    "LockoutEnabled" bool,
    "AccessFailedCount" bigint,
    supervisor_id bigint,
    first_name text NOT NULL,
    last_name text NOT NULL,
    last_login time without time zone,
    password_question text,
    active boolean,
    hidden boolean,
    created_at timestamp without time zone,
    created_by bigint,
    expiration_date timestamp without time zone,
    modified_at timestamp without time zone,
    modified_by bigint,
    id_adress bigint
);


ALTER TABLE public."User" OWNER TO postgres;




CREATE TABLE public.user_permission (
    id_user text NOT NULL,
    id_permission text NOT NULL
);


ALTER TABLE public.user_permission OWNER TO postgres;


CREATE VIEW public.user_permissions AS
 SELECT u."Id" AS userid,
    u."UserName",
    p."Name" AS "Permission"
   FROM ((public."User" u
     JOIN public.user_permission up ON ((up.id_user = u."Id")))
     JOIN public."Permission" p ON ((up.id_permission = p."Id")));


ALTER TABLE public.user_permissions OWNER TO postgres;


CREATE SEQUENCE public.user_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE public.user_seq OWNER TO postgres;



ALTER TABLE ONLY public."User"
    ADD CONSTRAINT "User_pkey" PRIMARY KEY ("Id");



ALTER TABLE ONLY public."Permission"
    ADD CONSTRAINT role_pkey PRIMARY KEY ("Id");




ALTER TABLE ONLY public.user_permission
    ADD CONSTRAINT fk_permission FOREIGN KEY (id_permission) REFERENCES public."Permission"("Id");


ALTER TABLE ONLY public.user_permission
    ADD CONSTRAINT fk_user FOREIGN KEY (id_user) REFERENCES public."User"("Id");


CREATE TABLE public.database_version (
    version bigint
);

ALTER TABLE public.database_version
    OWNER to postgres;

INSERT INTO public.database_version(version) VALUES (0);





